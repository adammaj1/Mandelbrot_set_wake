/*
http://math.bu.edu/people/bob/papers/monica.pdf

Algorithm is based on the Theorem 5.3 in: Geometry of the Antennas in the Mandelbrot Set by R L Devaney and M Moreno-Rocha, April 11, 2000[6]

=======

p/q = 1/3	b=1

j = 0	s-d^0(s+)
j = 1	s-d^1(s+)
j = 2	s+s-

==========================================

p/q = 1/4	b=1

j = 0	s-d^0(s+)
j = 1	s-d^1(s+)
j = 2	s-d^2(s+)
j = 3	s+s-


==========================================


p/q = 2/5	b=3

j = 0	s-d^0(s+)
j = 1	s-d^3(s+)
j = 2	s-d^6(s+)
j = 3	s+d^9(s+)
j = 4	s+s-
==========================================

p/q = 3/8	b=3

j = 0	s-d^0(s+)
j = 1	s-d^3(s+)
j = 2	s-d^6(s+)
j = 3	s-d^9(s+)
j = 4	s-d^12(s+)
j = 5	s+d^15(s+)
j = 6	s+d^18(s+)
j = 7	s+s-
==========================================

p/q = 3/4	b=3

j = 0	s-d^0(s+)
j = 1	s+d^3(s+)
j = 2	s+d^6(s+)
j = 3	s+s-
==========================================

p/q = 2/3	b=2

j = 0	s-d^0(s+)
j = 1	s+d^2(s+)
j = 2	s+s-
==========================================

p/q = 1/31	b=1

j = 0	s-d^0(s+)
j = 1	s-d^1(s+)
j = 2	s-d^2(s+)
j = 3	s-d^3(s+)
j = 4	s-d^4(s+)
j = 5	s-d^5(s+)
j = 6	s-d^6(s+)
j = 7	s-d^7(s+)
j = 8	s-d^8(s+)
j = 9	s-d^9(s+)
j = 10	s-d^10(s+)
j = 11	s-d^11(s+)
j = 12	s-d^12(s+)
j = 13	s-d^13(s+)
j = 14	s-d^14(s+)
j = 15	s-d^15(s+)
j = 16	s-d^16(s+)
j = 17	s-d^17(s+)
j = 18	s-d^18(s+)
j = 19	s-d^19(s+)
j = 20	s-d^20(s+)
j = 21	s-d^21(s+)
j = 22	s-d^22(s+)
j = 23	s-d^23(s+)
j = 24	s-d^24(s+)
j = 25	s-d^25(s+)
j = 26	s-d^26(s+)
j = 27	s-d^27(s+)
j = 28	s-d^28(s+)
j = 29	s-d^29(s+)
j = 30	s+s-


*/

#include <stdio.h> // printf
#include <stdlib.h> // abs




/*
 
 array of test values  
 p/q = internal angle ,  
 b is a denominator of lower Farey parent
 row = {p, q, b}
 */
int tt[][3] = {  
   {1 , 2 , 1},
{1 , 3 , 1},
{2 , 3 , 2},
{1 , 4 , 1},
{3 , 4 , 3},
{1 , 5 , 1},
{2 , 5 , 3},
{3 , 5 , 2},
{4 , 5 , 4},
{1 , 6 , 1},
{5 , 6 , 5},
{1 , 7 , 1},
{2 , 7 , 4},
{3 , 7 , 5},
{4 , 7 , 2},
{5 , 7 , 3},
{6 , 7 , 6},
{1 , 8 , 1},
{3 , 8 , 3},
{5 , 8 , 5},
{7 , 8 , 7},
{1 , 9 , 1},
{2 , 9 , 5},
{4 , 9 , 7},
{5 , 9 , 2},
{7 , 9 , 4},
{8 , 9 , 8},
{1 , 10 , 1},
{3 , 10 , 7},
{7 , 10 , 3},
{9 , 10 , 9},
{1 , 11 , 1},
{2 , 11 , 6},
{3 , 11 , 4},
{4 , 11 , 3},
{5 , 11 , 9},
{6 , 11 , 2},
{7 , 11 , 8},
{8 , 11 , 7},
{9 , 11 , 5},
{10 , 11 , 10},
{1 , 12 , 1},
{5 , 12 , 5},
{7 , 12 , 7},
{11 , 12 , 11},
{1 , 13 , 1},
{2 , 13 , 7},
{3 , 13 , 9},
{4 , 13 , 10},
{5 , 13 , 8},
{6 , 13 , 11},
{7 , 13 , 2},
{8 , 13 , 5},
{9 , 13 , 3},
{10 , 13 , 4},
{11 , 13 , 6},
{12 , 13 , 12},
{1 , 14 , 1},
{3 , 14 , 5},
{5 , 14 , 3},
{9 , 14 , 11},
{11 , 14 , 9},
{13 , 14 , 13},
{1 , 15 , 1},
{2 , 15 , 8},
{4 , 15 , 4},
{7 , 15 , 13},
{8 , 15 , 2},
{11 , 15 , 11},
{13 , 15 , 7},
{14 , 15 , 14},
{1 , 16 , 1},
{3 , 16 , 11},
{5 , 16 , 13},
{7 , 16 , 7},
{9 , 16 , 9},
{11 , 16 , 3},
{13 , 16 , 5},
{15 , 16 , 15},
{1 , 17 , 1},
{2 , 17 , 9},
{3 , 17 , 6},
{4 , 17 , 13},
{5 , 17 , 7},
{6 , 17 , 3},
{7 , 17 , 5},
{8 , 17 , 15},
{9 , 17 , 2},
{10 , 17 , 12},
{11 , 17 , 14},
{12 , 17 , 10},
{13 , 17 , 4},
{14 , 17 , 11},
{15 , 17 , 8},
{16 , 17 , 16},
{1 , 18 , 1},
{5 , 18 , 11},
{7 , 18 , 13},
{11 , 18 , 5},
{13 , 18 , 7},
{17 , 18 , 17},
{1 , 19 , 1},
{2 , 19 , 10},
{3 , 19 , 13},
{4 , 19 , 5},
{5 , 19 , 4},
{6 , 19 , 16},
{7 , 19 , 11},
{8 , 19 , 12},
{9 , 19 , 17},
{10 , 19 , 2},
{11 , 19 , 7},
{12 , 19 , 8},
{13 , 19 , 3},
{14 , 19 , 15},
{15 , 19 , 14},
{16 , 19 , 6},
{17 , 19 , 9},
{18 , 19 , 18},
{1 , 20 , 1},
{3 , 20 , 7},
{7 , 20 , 3},
{9 , 20 , 9},
{11 , 20 , 11},
{13 , 20 , 17},
{17 , 20 , 13},
{19 , 20 , 19},
{1 , 21 , 1},
{2 , 21 , 11},
{4 , 21 , 16},
{5 , 21 , 17},
{8 , 21 , 8},
{10 , 21 , 19},
{11 , 21 , 2},
{13 , 21 , 13},
{16 , 21 , 4},
{17 , 21 , 5},
{19 , 21 , 10},
{20 , 21 , 20},
{1 , 22 , 1},
{3 , 22 , 15},
{5 , 22 , 9},
{7 , 22 , 19},
{9 , 22 , 5},
{13 , 22 , 17},
{15 , 22 , 3},
{17 , 22 , 13},
{19 , 22 , 7},
{21 , 22 , 21},
{1 , 23 , 1},
{2 , 23 , 12},
{3 , 23 , 8},
{4 , 23 , 6},
{5 , 23 , 14},
{6 , 23 , 4},
{7 , 23 , 10},
{8 , 23 , 3},
{9 , 23 , 18},
{10 , 23 , 7},
{11 , 23 , 21},
{12 , 23 , 2},
{13 , 23 , 16},
{14 , 23 , 5},
{15 , 23 , 20},
{16 , 23 , 13},
{17 , 23 , 19},
{18 , 23 , 9},
{19 , 23 , 17},
{20 , 23 , 15},
{21 , 23 , 11},
{22 , 23 , 22},
{1 , 24 , 1},
{5 , 24 , 5},
{7 , 24 , 7},
{11 , 24 , 11},
{13 , 24 , 13},
{17 , 24 , 17},
{19 , 24 , 19},
{23 , 24 , 23},
{1 , 25 , 1},
{2 , 25 , 13},
{3 , 25 , 17},
{4 , 25 , 19},
{6 , 25 , 21},
{7 , 25 , 18},
{8 , 25 , 22},
{9 , 25 , 14},
{11 , 25 , 16},
{12 , 25 , 23},
{13 , 25 , 2},
{14 , 25 , 9},
{16 , 25 , 11},
{17 , 25 , 3},
{18 , 25 , 7},
{19 , 25 , 4},
{21 , 25 , 6},
{22 , 25 , 8},
{23 , 25 , 12},
{24 , 25 , 24},
{1 , 26 , 1},
{3 , 26 , 9},
{5 , 26 , 21},
{7 , 26 , 15},
{9 , 26 , 3},
{11 , 26 , 19},
{15 , 26 , 7},
{17 , 26 , 23},
{19 , 26 , 11},
{21 , 26 , 5},
{23 , 26 , 17},
{25 , 26 , 25},
{1 , 27 , 1},
{2 , 27 , 14},
{4 , 27 , 7},
{5 , 27 , 11},
{7 , 27 , 4},
{8 , 27 , 17},
{10 , 27 , 19},
{11 , 27 , 5},
{13 , 27 , 25},
{14 , 27 , 2},
{16 , 27 , 22},
{17 , 27 , 8},
{19 , 27 , 10},
{20 , 27 , 23},
{22 , 27 , 16},
{23 , 27 , 20},
{25 , 27 , 13},
{26 , 27 , 26},
{1 , 28 , 1},
{3 , 28 , 19},
{5 , 28 , 17},
{9 , 28 , 25},
{11 , 28 , 23},
{13 , 28 , 13},
{15 , 28 , 15},
{17 , 28 , 5},
{19 , 28 , 3},
{23 , 28 , 11},
{25 , 28 , 9},
{27 , 28 , 27},
{1 , 29 , 1},
{2 , 29 , 15},
{3 , 29 , 10},
{4 , 29 , 22},
{5 , 29 , 6},
{6 , 29 , 5},
{7 , 29 , 25},
{8 , 29 , 11},
{9 , 29 , 13},
{10 , 29 , 3},
{11 , 29 , 8},
{12 , 29 , 17},
{13 , 29 , 9},
{14 , 29 , 27},
{15 , 29 , 2},
{16 , 29 , 20},
{17 , 29 , 12},
{18 , 29 , 21},
{19 , 29 , 26},
{20 , 29 , 16},
{21 , 29 , 18},
{22 , 29 , 4},
{23 , 29 , 24},
{24 , 29 , 23},
{25 , 29 , 7},
{26 , 29 , 19},
{27 , 29 , 14},
{28 , 29 , 28},
{1 , 30 , 1},
{7 , 30 , 13},
{11 , 30 , 11},
{13 , 30 , 7},
{17 , 30 , 23},
{19 , 30 , 19},
{23 , 30 , 17},
{29 , 30 , 29},
   {1, 31, 1}   
};



int PrintRays(int t[3]){

	
	int p = t[0];
	int q = t[1];
	int b = t[2];
	int n;
	int j;
	
	printf("p/q = %d/%d\tb=%d\n\n", p, q, b); // input 
	for (j = 0; j< q-1; j++){ // there are q rays ( from 0 to q-1)
		
		n = j*b;
		printf("j = %d\t",j);
		if (j< q-p) 
			{printf("s-d^%d(s+)\n", n);}
			else printf("s+d^%d(s+)\n", n);
		
	
	}
	printf("j = %d\ts+s-\n",j); 
	printf("==========================================\n\n");

	return 0;



}



int main(){


	int i;
	
	int iMax = (int) (sizeof (tt) / sizeof (tt)[0]); // number of rows = number of test values 
	
	
	for (i=0; i<iMax; i++){
		PrintRays(tt[i]);
	}
	
	

	return 0;}
